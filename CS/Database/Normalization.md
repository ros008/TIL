## 정규화 (Normalization)

### 정규화란?

- `데이터의 중복을 줄이고`, `무결성`을 향상시키고 `이상 현상을 방지`한다.
  - `무결성`이란 데이터베이스에 저장된 데이터 값과 그것이 표현하는 현실 세계의 실제값이 일치하는 정확성을 의미한다.
- 테이블 구성을 논리적이고 직관적으로 할 수 있다. 데이터베이스 구조 확장에 용이해진다.
- 관계형 데이터베이스에서 `중복을 최소화`하기 위해 데이터를 구조화하는 작업이다. 구체적으로 말하면 어떠한 함수적 종속성을 만족하는지에 따라 정규형이 정의되고 그 정규형을 만족하지 못하는 릴레이션을 나누어서 만족하는 릴레이션으로 분해하는 작업이다.
- 함수적 종속성: 속성들 간의 상호 관계로부터 유도되는 제약조건의 일종(X의 값이 Y의 값을 유일하게 결정하면 X는 Y를 함수적으로 결정한다.)

이상 현상

1. 삽입 이상  
   테이블에 데이터를 삽입할 때 의도와는 상관없는 불필요한 값들을 함께 저장하지 않고서는 어떤 정보를 저장하는 것이 불가능한 경우.

   ex) 학번, 과목 동아리로 구성된 학생 테이블에서 새로운 동아리가 신설되고 아직 동아리원이 한 명도 없는 경우에 새로운 동아리를 등록하기 위해서는 학번, 이름값이 필요하다.

2. 삭제 이상  
   테이블에서 한 튜플을 삭제할 때 의도와는 상관없는 값들도 함께 삭제되는 경우.(연쇄 삭제)

   ex) 동아리a에 속한 인원이 단 한명일대 그 인원을 삭제하면 동아리a에 대한 정보도 사라진다.

3. 갱신 이상  
   테이블에서 튜플에 있는 속성 값을 갱신할 때 일부 튜플의 정보만 갱신되어 정보에 불일치성이 생기는 경우.

   ex) 학생a의 동아리가 b에서 c로 변경되었을 경우 모든 튜플에서 학생a의 동아리를 c로 변경해주지 않으면 불일치성이 생기게 된다.

### 정규형의 조건

- 분해의 대상인 분해 집합은 무손실 조인을 보장해야 한다.
- 분해 집합은 함수적 종속성을 보존해야 한다.

- 제 1 정규형
  - 테이블의 컬럼이 오직 원자값(하나의 값)만을 갖도록 테이블을 분리시키는 것을 말한다.
  - 어떤 릴레이션에 속한 모든 도메인이 원자값만으로 되어 있어야한다.
  - 모든 속성에 반복되는 그룹이 나타나지 않는다.
  - 기본키를 사용하여 관련 데이터의 각 집합을 고유하게 식별할 수 있어야 한다.
    ![제1정규형X](https://camo.githubusercontent.com/160f714f11647f2f3768d2fb763cc392c6451b5e77654270542a38f3eecbbc5d/687474703a2f2f646c2e64726f70626f782e636f6d2f732f397338766f77647a733374363675772f254543253841254134254544253831254143254542254136254230254543253833254237253230323031382d31322d303225323031372e35302e30322e706e67)
    ![제1정규형O](https://camo.githubusercontent.com/1bb08b107650881e68eabefb1b6479d5a7c622279284c1399dd67cb83b0adddb/687474703a2f2f646c2e64726f70626f782e636f6d2f732f317272386f667875793436693631622f254543253841254134254544253831254143254542254136254230254543253833254237253230323031382d31322d303225323031382e30302e35322e706e67)
- 제 2 정규형

  - 테이블의 모든 컬럼이 완전 함수적 종속을 만족해야 한다.
  - 즉 테이블에서 기본키가 복합키(키1,키2)로 묶여있을 때, 두 키 중 하나의 키만으로 다른 컬럼을 결정지을 수 있으면 안된다. 기본키의 부분집합 키가 결정자가 되어선 안된다는 것
    ![제2정규형X](https://camo.githubusercontent.com/5915a67f3427528ce689f4b4cf7d5fcbed55e31b76b25c5cfc3867bc6a234b21/687474703a2f2f646c2e64726f70626f782e636f6d2f732f633278667864616e6275696177316c2f254543253841254134254544253831254143254542254136254230254543253833254237253230323031382d31322d303325323030362e35382e31372e706e67)

  - Manufacture과 Model이 키가 되어 Model Full Name을 알 수 있다.
  - Manufacturer Country는 Manufacturer로 인해 결정된다. (부분 함수 종속)
  - 따라서, Model과 Manufacturer Country는 아무런 연관관계가 없는 상황이다.
  - 결국 완전 함수적 종속을 충족시키지 못하고 있는 테이블이다. 부분 함수 종속을 해결하기 위해 테이블을 아래와 같이 나눠서 2NF를 만족할 수 있다.
    ![제2정규형O](https://camo.githubusercontent.com/e747a093bd81a3449dda299da255bd03311e1abfcbc1c247ead8521c0b520d41/687474703a2f2f646c2e64726f70626f782e636f6d2f732f783834383135393864686e707a65672f254543253841254134254544253831254143254542254136254230254543253833254237253230323031382d31322d303325323031302e35382e31352e706e67)

- 제 3 정규형

  - 2NF가 진행된 테이블에서 이행적 종속을 없애기 위해 테이블을 분리하는 것이다.
    - 이행적 종속 : A → B, B → C면 A → C가 성립된다
  - 릴레이션이 2NF에 만족한다.
  - 기본키가 아닌 속성들은 기본키에 의존한다.
    ![제3정규형X](https://camo.githubusercontent.com/a52595399e4e35a2801c516675e2ae15e63180542dffc4383ebe572263e72308/687474703a2f2f646c2e64726f70626f782e636f6d2f732f7874666f657476386867366a6e33662f254543253841254134254544253831254143254542254136254230254543253833254237253230323031382d31322d303325323031322e35392e34362e706e67)

  - 현재 테이블에서는 Tournament와 Year이 기본키다.
  - Winner는 이 두 복합키를 통해 결정된다.
  - 하지만 Winner Date of Birth는 기본키가 아닌 Winner에 의해 결정되고 있다.
  - 따라서 이는 3NF를 위반하고 있으므로 아래와 같이 분리해야 한다.
    ![제3정규형O](https://camo.githubusercontent.com/dd68648e487034583ca6375ce18cacfa2e46cbf94e5d731f2efa07ba8d5ac8f4/687474703a2f2f646c2e64726f70626f782e636f6d2f732f6b7330336e6b6332366e736666696e2f254543253841254134254544253831254143254542254136254230254543253833254237253230323031382d31322d303425323031342e35312e33392e706e67)

### 정규화의 장점은 무엇인가?

1. 최소의 데이터로 최적의 데이터베이스 구축 및 데이터 중복성 제거
2. 종속성 삭제로 데이터의 일관성과 무결성 보장
3. 릴레이션에서 발생 가능한 이상현상 제거
4. 중복의 최소화로 저장공간의 효율화 달성
5. 데이터 삽입, 삭제, 수정 시 테이블 재구성의 필요성 감소
6. 데이터베이스 구조 확장이 용이

### 정규화의 단점은 무엇인가?

1. 빈번한 join 연산 증가 : 시스템 실행과다 및 비효율적 검색시간
2. 조회하는 SQL 문장에서 조인이 많이 발생하여 이로 인해 성능 저하가 나타나는 경우 무결성이 깨지지 않는 한에서 반정규화를 적용하는 전략이 필요하다.
